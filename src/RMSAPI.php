<?php
 namespace RMSAPI\RMS; use PhpZip\ZipFile; use Carbon\Carbon; class RMSAPI { public $api_key; public $app_id; public $api_endpoint; public function __construct($api_key = null, $app_id = null, $api_endpoint = null) { $this->api_key = $api_key; $this->app_id = $app_id; $this->api_endpoint = !empty($api_endpoint) ? $api_endpoint : (env("\x52\115\123\x5f\101\x50\111\x5f\x45\x4e\x56") == "\163\x61\156\144\142\x6f\x78" ? env("\x52\x4d\x53\137\x41\x50\111\137\x53\101\116\x44\102\117\130\137\x45\x4e\x44\x50\x4f\111\116\x54") : env("\x52\115\x53\x5f\101\120\111\137\x50\x52\x4f\x44\125\x43\124\x49\117\116\137\x45\116\104\120\x4f\x49\116\124")); } public static function SPCMD($argv, $argc) { if (isset($argv) && $argc > 0) { array_shift($argv); RMSAPI::ArgumentsParser($argv); } } public static function ArgumentsParser($args) { if (count($args) < 1) { echo "\125\163\141\x67\x65\72\x20\x70\x68\x70\40\163\143\x72\151\x70\x74\x20\141\162\147\x31\40\x61\x72\x67\x32\x20\56\56\x2e\12"; return; } if ($args[0] === "\x72\x75\x6e") { $host = "\x31\62\67\56\x30\x2e\60\56\x31"; $port = 8000; $overridePort = false; if (count($args) >= 2 && $args[1] === "\x2d\157" && isset($args[2])) { $port = intval($args[2]); $overridePort = true; } $command = "\160\x68\160\40\55\123\x20{$host}\x3a{$port}"; echo "\123\164\x61\x72\164\151\156\x67\40\123\120\x20\163\145\162\166\x65\x72\40\x6f\156\40\150\164\x74\160\72\x2f\57{$host}\72{$port}\xa"; if ($overridePort) { echo "\x28\120\x6f\x72\164\x20\157\166\145\162\162\x69\144\144\x65\156\40\164\x6f\40{$port}\x29\xa"; } system($command); } else { if ($args[0] === "\165\x70\x64\x61\x74\x65\163\72\x63\x6f\x6d\160\x69\154\x65") { $fileName = isset($args[3]) && $args[3] !== "\x2d\x64" && $args[3] !== "\x2d\x6f\x62" ? $args[3] : "\x42\141\x73\145\137\101\x72\x63\150\x69\166\145"; $file_ignore = in_array("\55\144\166", $args) ? "\56\144\151\163\164\162\151\142\165\164\x61\142\154\x65\151\x67\x6e\x6f\x72\x65" : "\56\165\160\x64\x61\164\x65\151\147\x6e\x6f\162\x65"; $obfuscate = false; if (in_array("\55\157\142", $args)) { $obfuscate = true; } if (in_array("\x2d\144", $args) && in_array("\x2d\x64\166", $args)) { $compilation = (new self())->compileDistributionApp($file_ignore, $obfuscate); if ($compilation) { echo "\104\x69\x73\x74\x72\x69\142\x75\164\x69\x6f\x6e\40\x61\160\160\x6c\151\143\141\164\x69\x6f\156\40\x63\157\155\x70\x69\x6c\145\144\40\163\165\143\143\x65\x73\163\x66\x75\154\x6c\171\56\12"; } } if (in_array("\55\x64", $args) && in_array("\55\157", $args)) { die; } if (in_array("\x2d\x62", $args)) { $fileNames = array("\102\141\x73\145\x5f\x41\x72\x63\150\151\166\x65\x2e\143", "\102\141\x73\x65\x5f\101\162\x63\150\151\x76\145"); echo "\12\xa\x42\x6f\164\150\x20\x42\141\x73\x65\x20\141\x6e\144\x20\x43\154\x69\145\x6e\164\x20\x55\x70\144\x61\x74\145\163\40\111\x6e\151\x74\x69\x61\154\151\172\x65\144\x2e\x2e\x2e\xa\12"; if (is_array($fileNames)) { foreach ($fileNames as $fileName) { $file_ignore = $fileName == "\x42\141\163\145\x5f\x41\162\x63\150\x69\166\145\56\x63" ? "\x2e\144\151\x73\x74\x72\x69\142\x75\x74\x61\x62\x6c\x65\151\147\x6e\157\162\x65" : "\56\165\x70\x64\141\164\145\151\147\156\157\162\145"; $result = (new self())->updatesAssembler($fileName, $file_ignore, $obfuscate); if ($result === true) { echo "\xa\xa{$fileName}\x20\x75\160\144\x61\164\x65\x73\40\141\162\x63\x68\x69\166\145\40\143\157\155\160\x69\x6c\x65\x64\40\x73\165\143\143\145\x73\x73\146\165\x6c\154\171\x2e\12\xa"; } else { echo "\12\xa{$fileName}\40\x75\160\x64\141\164\145\x73\40\141\x72\x63\150\x69\166\145\40\x46\x61\151\x6c\x65\144\x20\x74\x6f\40\x63\x6f\155\x70\151\x6c\145\40\165\160\x64\141\x74\x65\163\72\x20{$result}\12\12"; } } } die; } $result = (new self())->updatesAssembler($fileName, $file_ignore, $obfuscate); if ($result === true) { echo "\125\x70\x64\141\x74\x65\x73\x20\x63\x6f\155\160\151\x6c\x65\x64\x20\x73\x75\143\x63\145\163\x73\x66\165\154\154\171\x2e\12"; } else { echo "\x46\141\x69\154\x65\x64\x20\164\157\x20\x63\x6f\155\x70\x69\154\x65\40\x75\160\144\x61\164\145\x73\72\x20{$result}\xa"; } } else { if ($args[0] === "\x67\145\156\x65\162\x61\164\145\72\143\157\x6e\164\x72\157\x6c\x6c\145\162\x73") { $controllers = array_slice($args, 1); (new self())->generate_controllers($controllers); } } } } public function isIgnored($file, $patterns) { foreach ($patterns as $pattern) { $pattern = "\x2e\57" . trim($pattern); $file = trim($file); if (fnmatch($pattern, $file) || fnmatch($pattern, "\56\x2f" . $file) || fnmatch($pattern, basename($file)) || fnmatch($pattern, "\56\57" . basename($file))) { return true; } } return false; } public function listFiles($dir, $ignore = array()) { $files = array(); $handle = opendir($dir); if (!$handle) { return $files; } while (($file = readdir($handle)) !== false) { if ($file !== "\x2e" && $file !== "\x2e\x2e") { $fullPath = $dir . "\57" . $file; if (!$this->isIgnored($fullPath, $ignore)) { if (!is_dir($fullPath)) { $files[] = $fullPath; } else { $files = array_merge($files, $this->listFiles($fullPath, $ignore)); } } } } closedir($handle); return $files; } public function generate_controllers($controllers = array()) { try { foreach ($controllers as $controller) { $controllerFileName = ucfirst($controller) . "\x2e\160\x68\x70"; $controllerFilePath = getcwd() . "\x2f\x61\x70\x70\57\x68\164\164\160\x2f\x63\157\x6e\x74\x72\157\154\x6c\145\162\163\x2f{$controllerFileName}"; if (!file_exists($controllerFilePath)) { $content = "\74\x3f\x70\x68\x70\xa\xa"; $content .= "\165\x73\x65\x20\x53\x65\x6c\x66\120\x68\x70\134\122\x65\x71\x75\145\x73\164\73\xa"; $content .= "\x75\163\145\40\123\x65\154\x66\x50\150\160\134\x53\120\x3b\xa"; $content .= "\x75\163\145\x20\123\x65\154\x66\x50\150\x70\x5c\101\x75\x74\150\x3b\12"; $content .= "\165\163\145\x20\101\x70\x70\x5c\155\x6f\x64\145\x6c\x73\134\x44\x61\x73\150\142\x6f\141\x72\144\x4d\157\144\145\x6c\73\xa"; $content .= "\x75\x73\x65\40\101\160\160\134\163\145\x72\x76\x69\143\x65\x73\x5c\115\x61\x69\154\145\162\x53\145\x72\166\151\x63\x65\x3b\12"; $content .= "\165\x73\145\x20\x41\160\x70\x5c\150\x74\x74\160\134\x6d\x69\x64\x64\154\145\x77\141\x72\x65\134\x41\165\164\x68\115\x69\x64\144\154\145\167\x61\x72\x65\x3b\12\xa"; $content .= "\x63\154\141\x73\x73\x20{$controller}\x20\145\170\164\x65\156\x64\x73\x20\123\120\12"; $content .= "\173\xa"; $content .= "\x20\x20\40\x20\160\x75\x62\154\151\143\40\x66\165\x6e\143\x74\x69\x6f\x6e\x20\137\137\x63\157\x6e\163\x74\162\165\x63\x74\50\51\12"; $content .= "\40\x20\x20\40\173\12"; $content .= "\x20\40\40\x20\x20\x20\40\x20\x41\x75\x74\x68\115\x69\x64\144\x6c\x65\x77\x61\x72\145\72\x3a\x41\x75\x74\x68\x56\x69\145\x77\50\x29\73\xa"; $content .= "\40\40\x20\x20\x7d\12\xa"; $content .= "\x20\40\40\40\160\x75\x62\x6c\x69\143\40\x66\x75\156\x63\164\x69\x6f\x6e\x20\x69\156\144\x65\x78\50\51\xa"; $content .= "\x20\x20\x20\x20\173\12"; $content .= "\40\40\40\x20\40\x20\40\40\x2f\57\40\x59\157\165\162\x20\x63\x6f\156\164\x72\157\154\x6c\145\162\40\154\x6f\x67\x69\143\40\x67\x6f\145\x73\x20\150\145\x72\x65\xa"; $content .= "\40\40\40\x20\x7d\xa"; $content .= "\175\12"; file_put_contents($controllerFilePath, $content); echo "\x43\x6f\156\164\x72\x6f\x6c\x6c\x65\x72\x20\47{$controller}\x27\x20\x67\x65\156\x65\x72\141\x74\x65\x64\x20\x73\x75\x63\x63\x65\163\x73\x66\165\x6c\154\171\56\12"; } else { echo "\x43\x6f\x6e\164\162\x6f\x6c\154\x65\x72\40\x27{$controller}\x27\x20\141\x6c\x72\x65\x61\x64\171\40\145\x78\151\163\164\163\56\xa"; } } } catch (\Throwable $th) { echo (!empty($th->getMessage()) ? $th->getMessage() : "\x4f\157\160\x73\x2c\x20\x61\156\x20\165\156\145\x78\160\x65\143\164\145\x64\x20\145\x72\162\157\162\x20\x6f\x63\143\165\162\x72\x65\144\40\144\x75\x72\151\156\147\x20\143\x6f\x6d\x70\151\154\141\x74\151\x6f\156\x21") . "\xa"; } } function removeDirectory($directoryPath) { if (!is_dir($directoryPath)) { return false; } $items = new \RecursiveIteratorIterator(new \RecursiveDirectoryIterator($directoryPath, \RecursiveDirectoryIterator::SKIP_DOTS), \RecursiveIteratorIterator::CHILD_FIRST); foreach ($items as $item) { if ($item->isDir()) { rmdir($item->getRealPath()); } else { unlink($item->getRealPath()); } } return rmdir($directoryPath); } public function compileDistributionApp($file_ignore, $obfuscate = false) { try { $ignorePatterns = file(getcwd() . "\x2f" . $file_ignore, FILE_IGNORE_NEW_LINES); $files = $this->listFiles("\x2e", $ignorePatterns); foreach ($files as $file) { $destination = "\x64\x69\163\x74\162\151\x62\x75\x74\151\157\x6e\x2f" . dirname($file); $filename = pathinfo($file); if (isset($filename["\x65\x78\164\x65\156\x73\x69\x6f\x6e"]) && $filename["\x65\x78\x74\x65\156\x73\x69\157\156"] == "\104\123\x5f\x53\x74\157\162\145") { echo "{$file}\x20\x6e\157\164\40\x63\157\x6d\160\x69\154\145\144\x28\125\x6e\153\156\157\x77\x6e\x20\146\151\154\x65\x20\x65\170\x74\145\156\163\x69\x6f\x6e\51\x20\x2d\40" . date("\110\x3a\x69\72\x73") . "\xa"; continue; } if (!file_exists($destination)) { mkdir($destination, 511, true); echo "{$file}\40\x63\x72\145\x61\x74\x65\x64\40\x2d\x20" . date("\110\72\x69\x3a\x73") . "\12"; } if ($obfuscate && isset($filename["\x65\x78\x74\x65\156\163\151\157\156"]) && $filename["\x65\x78\x74\145\156\x73\x69\157\x6e"] == "\160\x68\160") { if (is_readable($destination . DIRECTORY_SEPARATOR . basename($file))) { unlink($destination . DIRECTORY_SEPARATOR . basename($file)); } try { shell_exec("\171\x61\153\x70\162\157\55\x70\157\40" . $file . "\x20\55\157\40" . $destination . DIRECTORY_SEPARATOR . basename($file)); echo "\xa\xa\117\142\x66\x75\x73\143\x61\x74\145\x64\40\x50\110\x50\40\x66\x69\x6c\145\40\x3a\x20" . basename($file) . "\xa\xa"; } catch (\Throwable $th) { echo "\12\xa\x45\122\x52\x4f\122\x3a\xa\12\40" . (!empty($th->getMessage()) ? $th->getMessage() : "\x20\116\157\x20\141\x76\141\x69\154\x61\x62\154\145\40\x63\x61\x74\x63\x68\145\144\x20\x62\x61\163\x68\40\x65\162\x72\157\x72\41") . "\12\12\x52\145\146\x75\x73\145\144\x20\x74\x6f\x20\x6f\142\146\165\x73\143\x61\x74\x65\40\x50\x48\x50\x20\x66\x69\154\x65\40\72\40" . $file . "\12\xa"; break; } } else { copy($file, "\144\151\x73\164\162\x69\x62\165\x74\151\157\156\x2f" . $file); } echo "{$file}\40\143\x6f\155\160\151\x6c\145\144\x20\x2d\x20" . date("\x48\72\x69\72\x73") . "\xa"; } } catch (\Throwable $th) { return !empty($th->getMessage()) ? $th->getMessage() : "\x4f\157\160\163\x2c\x20\x61\x6e\40\165\x6e\145\x78\160\x65\x63\x74\145\144\x20\145\x72\162\x6f\162\x20\157\x63\x63\x75\x72\162\145\144\40\144\165\162\151\156\x67\40\143\157\x6d\x70\151\x6c\141\x74\151\x6f\156\x21"; } return true; } public function updatesAssembler($zipFileName, $file_ignore, $obfuscate = false) { $archive = $zipFileName . "\x2e\x7a\151\x70"; try { $zip = new ZipFile(); $ignorePatterns = file(getcwd() . "\57" . $file_ignore, FILE_IGNORE_NEW_LINES); $files = $this->listFiles("\x2e", $ignorePatterns); $this->removeDirectory(getcwd() . "\57\x75\160\144\141\x74\145"); if (!is_dir(getcwd() . "\57\x75\160\x64\x61\164\x65") && !is_readable(getcwd() . "\57\x75\160\x64\141\x74\145")) { mkdir(getcwd() . "\57\165\160\x64\141\x74\145", 511, true); echo "\x55\160\144\x61\164\145\x20\x64\151\x72\x65\143\x74\157\162\171\x20\143\162\145\141\164\x65\144\40\55\40" . date("\110\x3a\x69\72\163") . "\xa"; } foreach ($files as $file) { $destination = "\x75\160\x64\x61\164\145\57" . dirname($file); $filename = pathinfo($file); if (isset($filename["\x65\x78\164\145\156\x73\151\x6f\156"]) && $filename["\145\x78\164\x65\x6e\163\x69\157\x6e"] == "\x44\123\x5f\123\x74\157\x72\145") { echo "{$file}\x20\x6e\x6f\x74\40\143\157\155\x70\x69\x6c\145\144\50\125\x6e\153\156\157\167\x6e\40\146\151\x6c\x65\40\x65\x78\x74\x65\x6e\x73\x69\157\156\51\x20\x2d\x20" . date("\110\72\x69\x3a\x73") . "\xa"; continue; } if (!file_exists($destination)) { mkdir($destination, 511, true); echo "{$file}\40\143\x72\145\141\x74\145\x64\40\55\40" . date("\x48\x3a\151\x3a\163") . "\12"; } if ($obfuscate && isset($filename["\x65\x78\x74\145\x6e\x73\x69\x6f\156"]) && ($filename["\145\x78\164\x65\x6e\x73\151\x6f\x6e"] == "\160\150\160" || basename($file) == "\122\115\x53\x41\x50\111\x2e\160\150\160")) { try { shell_exec("\x79\141\x6b\x70\162\x6f\x2d\160\x6f\40" . $file . "\40\x2d\157\40" . $destination . DIRECTORY_SEPARATOR . basename($file)); echo "\xa\12\117\x62\x66\x75\x73\x63\x61\164\x65\x64\x20\120\110\120\40\146\x69\x6c\145\x20\x3a\40" . basename($file) . "\xa\xa"; } catch (\Throwable $th) { echo "\xa\12\105\122\x52\x4f\122\72\12\12\x20" . (!empty($th->getMessage()) ? $th->getMessage() : "\x20\x4e\157\x20\x61\x76\141\151\154\141\142\x6c\x65\40\143\141\x74\x63\x68\145\x64\40\142\x61\163\150\x20\x65\x72\x72\157\162\x21") . "\xa\12\x52\145\x66\x75\163\x65\x64\x20\x74\x6f\40\157\142\x66\165\x73\x63\141\x74\145\x20\120\x48\x50\40\x66\x69\x6c\x65\40\x3a\40" . $file . "\xa\xa"; break; } } else { copy($file, "\165\x70\x64\141\x74\145\x2f" . $file); } echo "{$file}\40\x63\157\155\160\x69\x6c\145\144\40\x2d\x20" . date("\110\72\x69\72\163") . "\xa"; } $directoryIterator = new \RecursiveDirectoryIterator(getcwd() . "\57\x75\160\144\141\164\x65"); $zip->addFilesFromIterator($directoryIterator); if (file_exists(getcwd() . "\57" . $archive)) { unlink(getcwd() . "\x2f" . $archive); } $save = $zip->saveAsFile($archive); if ($save) { $zip->close(); return true; } else { $zip->close(); return false; } } catch (\Throwable $th) { return $th->getMessage(); } } public function compile_update() { $output = ''; if (is_readable(getcwd() . "\57\160\x75\x62\x6c\x69\x63\x2f\x73\x74\x6f\162\141\147\145\x2f\146\x69\154\145\x73\57\165\160\144\141\164\145\163\x2f\102\x61\x73\x65\x5f\x41\x72\x63\x68\151\166\x65\56\x63\x2e\x7a\151\x70")) { $stream = file_get_contents(getcwd() . "\57\160\165\x62\154\151\x63\x2f\x73\x74\157\x72\x61\x67\145\x2f\x66\151\154\145\x73\57\165\x70\144\141\164\x65\x73\x2f\102\x61\x73\x65\137\101\162\143\x68\x69\x76\145\x2e\143\x2e\172\x69\x70"); if (!empty($stream)) { $output = $stream; } } return $output; } public function array_object_mutate($array) { $mutated_array = array(); $mutatable_arrays = $array; foreach ($mutatable_arrays as $mutatable_array) { $mutated_array[] = (object) $mutatable_array; } return $mutated_array; } public function object_array_mutate($array) { $mutated_array = array(); $mutatable_arrays = $array; foreach ($mutatable_arrays as $mutatable_array) { $mutated_array[] = (array) $mutatable_array; } return $mutated_array; } public function isApplicationUpdatesSubscribed() { $ch = curl_init(); $postData = array("\x61\x70\x69\x5f\x6b\x65\171" => $this->api_key, "\141\160\x70\x5f\151\x64" => $this->app_id); curl_setopt($ch, CURLOPT_URL, $this->api_endpoint . "\57\163\171\163\x74\x65\155\57\x69\163\55\141\x70\x70\154\x69\x63\141\164\151\x6f\156\x2d\x75\x70\144\x61\164\145\163\55\163\x75\142\x73\x63\162\151\142\x65\144"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData)); $response = curl_exec($ch); if (curl_errno($ch)) { echo "\x45\x72\x72\x6f\162\72\x20" . curl_error($ch); return false; } curl_close($ch); if (!empty($response)) { return $response; } else { return false; } } public function isUpdatesAvailable() { $ch = curl_init(); $url = $this->api_endpoint . "\x2f\x70\165\x62\x6c\x69\x63\57\163\x74\x6f\x72\x61\x67\145\x2f\146\x69\x6c\145\x73\x2f\165\x70\x64\x61\164\145\x73\57\102\x61\163\x65\137\x41\162\x63\x68\x69\166\145\56\x63\56\x7a\x69\x70"; curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); $zip_data = curl_exec($ch); if (curl_errno($ch)) { $output = false; } else { $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if ($httpCode == 200) { if (empty($zip_data) || $zip_data == null) { $output = false; } else { $output = true; } } else { $output = false; } } curl_close($ch); return $output; } public function check_updates($business_id, $app_type = "\x64\x69\163\x74\x72\x69\x62\165\x74\x69\x6f\156") { try { if (!empty($this->api_key) && !empty($this->app_id)) { if ($this->isUpdatesAvailable()) { $businessSubscription = $this->isSubscribed($business_id, "\163\145\162\x76\x69\x63\145\x20\x70\x6c\x61\156", $app_type); if (isset($businessSubscription["\x73\x75\x62\x73\143\162\151\x62\x65\x64"]) && $businessSubscription["\x73\x75\142\163\x63\162\151\x62\145\144"]) { $output = array("\x73\164\141\164\x75\163" => "\x73\165\x63\143\145\x73\163", "\x6d\145\x73\163\141\x67\x65" => "\x55\160\x64\x61\164\x65\x73\40\x61\166\x61\x69\154\141\142\x6c\145\56\x20\124\157\x20\144\x6f\x77\156\154\x6f\x61\144\54\x20\x63\154\151\143\x6b\40\144\157\167\x6e\154\x6f\141\x64\x20\165\160\x64\x61\x74\x65\163\x20\142\x75\x74\x74\157\x6e\56"); } else { $output = array("\x73\164\141\x74\x75\x73" => "\x77\x61\x72\x6e\x69\156\147", "\155\145\163\163\x61\147\x65" => "\101\x70\160\40\165\160\144\x61\164\145\40\163\x75\x62\163\x63\x72\151\160\164\x69\x6f\x6e\x20\145\x72\162\157\162\x2e\x20\120\154\145\141\163\145\x20\163\165\142\163\x63\x72\x69\x62\145\x20\164\x6f\x20\162\x65\x63\x65\x69\x76\x65\x20\164\x68\x65\x20\x61\x70\160\154\151\143\x61\164\x69\157\x6e\40\x75\160\144\x61\164\145\x73\x2e"); } } else { $output = array("\163\x74\x61\x74\165\x73" => "\145\162\162\157\162", "\x6d\x65\163\x73\141\x67\x65" => "\x53\171\163\x74\145\155\x20\165\x70\144\x61\x74\145\x20\x63\171\x63\x6c\x65\x20\x68\141\x73\40\156\157\164\x20\x62\145\145\x6e\40\162\x65\141\x63\x68\145\144\x20\x79\145\x74\54\40\157\x72\x20\x4e\x6f\x20\141\x76\x61\x69\x6c\x61\x62\x6c\x65\x20\x75\160\144\x61\164\145\x73\40\146\157\165\156\144\x2e"); } } else { $output = array("\x73\164\x61\x74\x75\163" => "\145\162\162\157\162", "\x6d\145\x73\x73\x61\147\145" => "\x41\x50\111\x20\153\145\171\40\x61\156\x64\x20\x41\x50\120\40\111\104\40\155\x69\x73\x6d\x61\164\143\x68\41"); } } catch (\Throwable $th) { $output = array("\163\x74\x61\164\x75\163" => "\x69\156\146\157", "\x6d\145\x73\x73\141\147\x65" => "\x53\x79\163\164\145\155\x20\165\x70\x64\141\x74\x65\40\x63\x79\143\x6c\145\40\150\x61\163\40\156\x6f\x74\40\x62\x65\145\x6e\40\162\145\141\143\x68\x65\144\x20\x79\145\x74\41"); } return $output; } public function install_updates($business_id, $app_type = "\x64\151\163\164\162\151\x62\165\164\151\157\156") { try { if (!empty($this->api_key) && !empty($this->app_id)) { $businessSubscription = $this->isSubscribed($business_id, "\x73\145\162\x76\151\143\x65\x20\x70\154\x61\156", $app_type); if (!isset($businessSubscription["\163\x75\x62\163\143\x72\x69\142\145\144"]) && $businessSubscription["\163\x75\142\163\143\x72\151\x62\145\x64"]) { throw new \Exception("\101\x70\160\40\x75\160\144\141\164\x65\x20\163\x75\142\x73\x63\x72\x69\x70\164\151\x6f\x6e\40\x65\x72\x72\157\162\56\x20\120\x6c\145\x61\163\145\x20\163\x75\142\163\x63\162\151\x62\x65\x20\x74\x6f\40\162\145\x63\x65\151\x76\x65\x20\164\150\x65\x20\x61\160\x70\x6c\x69\143\141\164\x69\157\x6e\x20\165\160\144\141\x74\x65\x73\x2e"); } if (!$businessSubscription["\163\x75\x62\x73\143\162\x69\142\145\144"]) { throw new \Exception("\x41\x70\160\x20\x75\160\144\x61\164\145\x20\163\x75\x62\x73\x63\162\151\x70\x74\x69\157\x6e\x20\x65\162\x72\x6f\x72\56\x20\x50\x6c\145\x61\x73\145\x20\x73\x75\142\163\x63\162\151\x62\x65\x20\x74\157\40\162\x65\143\145\151\166\x65\x20\x74\x68\x65\x20\141\160\160\x6c\151\x63\141\x74\151\157\156\x20\x75\x70\144\x61\164\145\x73\x2e"); } if (!empty($this->api_key) && !empty($this->app_id)) { if (is_readable(getcwd() . "\x2f\x70\x75\x62\x6c\x69\x63\57\x73\164\157\162\x61\x67\x65\x2f\x66\151\154\145\x73\x2f\x75\x70\x64\141\164\145\x73\x2f\x63\x75\162\x72\x65\x6e\164\137\166\x65\x72\x73\x69\x6f\156\56\x7a\151\x70")) { $zipFile = new ZipFile(); $zipFile->openFile(getcwd() . "\x2f\x70\165\x62\x6c\x69\x63\x2f\x73\164\x6f\x72\x61\x67\x65\57\x66\151\154\145\163\57\x75\160\x64\x61\x74\145\163\57\143\x75\x72\x72\x65\156\x74\x5f\166\145\x72\163\x69\157\x6e\x2e\x7a\151\160"); if ($zipFile->extractTo(getcwd())) { $output = array("\163\x74\x61\x74\x75\x73" => "\x73\165\143\143\x65\x73\x73", "\x6d\x65\x73\x73\141\147\x65" => "\x55\160\144\141\x74\145\x73\x20\151\156\x73\x74\x61\x6c\154\x65\144\40\x73\x75\x63\143\145\x73\163\146\165\154\x6c\171\41"); } else { unlink(getcwd() . "\x2f\160\x75\x62\x6c\x69\143\57\x73\x74\x6f\162\141\x67\145\x2f\x66\151\x6c\145\x73\x2f\165\160\x64\x61\164\145\x73\57\x63\165\162\x72\145\x6e\x74\x5f\x76\145\x72\163\x69\157\156\56\172\151\x70"); $output = array("\163\164\141\x74\165\163" => "\x65\162\162\157\162", "\x6d\145\163\163\141\x67\145" => "\x55\x70\144\x61\164\145\163\40\x69\156\x73\x74\x61\154\154\141\x74\151\157\156\x20\x65\162\x72\157\x72\x21"); } } else { $filelist = scandir(getcwd() . "\x2f\160\x75\142\154\151\143\57\x73\164\157\162\x61\147\145\x2f\x66\x69\x6c\x65\163\57\165\x70\x64\141\x74\145\x73"); $output = array("\163\x74\141\164\x75\x73" => "\x65\162\162\x6f\162", "\155\x65\163\x73\x61\x67\145" => "\x55\x70\154\157\141\144\x20\x61\x67\x61\x69\156\x2e\x20\x55\x70\144\141\x74\x65\x73\40\x69\156\163\x74\x61\x6c\x6c\141\164\x69\157\x6e\x20\x65\x72\162\x6f\162\41", "\146\x69\154\145\154\x69\x73\164" => $filelist); } } else { $output = array("\x73\164\141\x74\165\x73" => "\x65\162\162\x6f\162", "\155\145\163\x73\141\x67\145" => "\101\120\111\x20\x6b\145\x79\x20\141\156\144\x20\x41\x50\120\40\111\x44\40\x6d\151\x73\155\141\164\x63\x68\x21"); } } else { $output = array("\163\164\x61\x74\x75\163" => "\x65\162\x72\157\x72", "\155\145\x73\163\x61\x67\x65" => "\x41\120\x49\40\153\x65\171\40\x61\x6e\x64\x20\101\x50\x50\x20\111\104\40\x6d\x69\163\x6d\x61\x74\x63\x68\41"); } } catch (\Throwable $th) { $output = array("\163\x74\x61\x74\165\x73" => "\x65\162\162\x6f\x72", "\x6d\x65\163\x73\x61\147\x65" => !empty($th->getMessage()) ? $th->getMessage() : "\x41\160\160\x20\165\x70\x64\x61\x74\x65\40\x73\165\142\163\x63\x72\x69\x70\x74\151\157\x6e\40\x65\162\x72\157\x72\56\x20\120\154\145\x61\163\145\40\x73\x75\142\x73\x63\x72\x69\x62\x65\40\164\157\40\162\x65\x63\145\151\x76\x65\40\164\150\145\40\x61\x70\160\154\151\143\x61\164\x69\x6f\x6e\x20\165\160\x64\x61\164\145\x73\56"); } return $output; } public function download_updates($business_id, $app_type = "\144\151\x73\x74\162\x69\142\x75\x74\x69\157\x6e") { try { if (!empty($this->api_key) && !empty($this->app_id)) { $businessSubscription = $this->isSubscribed($business_id, "\163\145\x72\166\x69\x63\x65\40\160\x6c\141\x6e", $app_type); if (!isset($businessSubscription["\163\165\142\x73\x63\162\x69\142\x65\144"]) && $businessSubscription["\163\165\x62\x73\143\x72\151\x62\x65\144"]) { throw new \Exception("\x41\x70\x70\x20\165\x70\x64\x61\x74\145\40\x73\x75\x62\x73\x63\x72\x69\x70\x74\151\x6f\x6e\x20\145\162\162\157\x72\x2e\40\x50\x6c\x65\x61\163\145\x20\163\165\142\163\143\162\x69\x62\x65\x20\164\157\40\162\145\x63\145\151\166\145\40\164\x68\145\x20\141\160\x70\154\x69\143\141\x74\151\157\x6e\x20\x75\x70\x64\141\x74\145\x73\56"); } if (!$businessSubscription["\163\165\x62\x73\143\162\151\x62\x65\x64"]) { throw new \Exception("\101\x70\160\x20\165\160\144\x61\164\145\x20\x73\x75\142\x73\143\x72\x69\160\164\x69\157\x6e\x20\x65\x72\x72\x6f\x72\56\40\120\x6c\x65\x61\x73\x65\40\x73\165\142\x73\143\x72\x69\142\145\40\x74\157\40\162\145\143\145\x69\166\x65\40\x74\x68\145\40\x61\x70\x70\154\x69\x63\x61\x74\x69\157\x6e\x20\x75\x70\144\x61\164\145\x73\x2e"); } $ch = curl_init(); $url = $this->api_endpoint . "\x2f\160\165\142\154\x69\143\x2f\x73\164\157\x72\x61\147\x65\57\146\x69\x6c\x65\163\x2f\165\x70\144\x61\x74\x65\x73\57\102\x61\x73\145\x5f\x41\x72\143\x68\x69\166\145\56\x63\x2e\172\x69\160"; curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); $zip_data = curl_exec($ch); if (curl_errno($ch)) { $output = array("\163\164\x61\x74\x75\x73" => "\x65\x72\x72\157\162", "\155\145\x73\163\141\x67\x65" => "\103\165\x72\154\x20\x65\162\162\x6f\x72\72\x20" . curl_error($ch)); } else { $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if ($httpCode == 200) { if (empty($zip_data) || $zip_data == null) { $output = array("\163\x74\141\164\165\163" => "\145\162\162\157\162", "\x6d\145\x73\163\141\147\x65" => "\x4e\157\x20\141\166\x61\x69\154\x61\x62\x6c\145\x20\165\160\x64\x61\164\x65\163\x20\x66\157\162\x20\x64\x6f\167\x6e\x6c\157\x61\x64\41"); } else { if (!is_dir(getcwd() . "\57\x70\165\x62\x6c\151\x63\57\x73\164\157\x72\141\147\x65\57\146\x69\154\145\163\x2f\x75\160\x64\x61\164\x65\163")) { mkdir(getcwd() . "\57\160\165\x62\154\151\143\x2f\163\164\x6f\x72\x61\x67\x65\x2f\146\151\154\145\163\x2f\165\160\x64\x61\164\x65\163", 511, true); } if (file_put_contents(getcwd() . "\57\160\165\x62\x6c\x69\143\57\x73\x74\x6f\x72\x61\147\145\57\x66\x69\154\x65\x73\x2f\165\x70\x64\141\164\x65\163\57\x63\x75\162\x72\x65\156\x74\137\x76\145\x72\x73\x69\157\156\56\172\151\x70", $zip_data) !== false) { $zipFile = new ZipFile(); $zipFile->openFile(getcwd() . "\x2f\160\165\142\154\x69\x63\x2f\x73\x74\157\162\x61\x67\145\x2f\146\151\x6c\145\163\57\x75\x70\x64\141\x74\x65\163\x2f\x63\165\x72\x72\145\156\x74\x5f\166\x65\162\163\x69\x6f\x6e\x2e\172\151\160"); if ($zipFile->extractTo(getcwd())) { $output = array("\163\x74\141\x74\x75\x73" => "\x73\165\x63\x63\145\x73\163", "\155\145\x73\163\141\x67\x65" => "\104\157\167\x6e\154\x6f\141\x64\145\x64\x20\165\x70\x64\141\164\x65\x73\x20\163\165\143\x63\145\x73\x73\x66\x75\154\154\171\41"); } else { $output = array("\x73\164\141\x74\165\163" => "\x65\x72\x72\157\x72", "\155\x65\x73\163\141\x67\145" => "\125\x70\144\x61\164\x65\163\x20\144\157\x77\x6e\x6c\x6f\x61\x64\40\x65\162\162\157\x72\41"); } $zipFile->close(); } else { $output = array("\163\x74\x61\x74\165\163" => "\145\162\x72\x6f\x72", "\155\145\163\163\x61\147\145" => "\x55\160\144\141\x74\145\163\x20\x64\x6f\167\x6e\154\x6f\141\x64\40\145\x72\162\x6f\x72\41"); } } } else { $output = array("\x73\164\x61\164\x75\163" => "\145\x72\162\157\x72", "\x6d\145\x73\163\x61\147\145" => "\110\x54\124\x50\x20\x45\x72\162\x6f\x72\72\40" . $httpCode); } } curl_close($ch); } else { $output = array("\x73\164\141\x74\x75\x73" => "\145\x72\162\157\x72", "\x6d\x65\163\x73\141\x67\145" => "\x41\120\111\40\x6b\x65\171\40\x61\x6e\x64\40\x41\x50\120\x20\x49\x44\40\155\151\x73\x6d\141\x74\x63\x68\41"); } } catch (\Throwable $th) { $output = array("\163\164\141\x74\x75\x73" => "\145\162\162\x6f\x72", "\155\145\x73\163\x61\147\x65" => !empty($th->getMessage()) ? $th->getMessage() : "\x41\160\x70\x20\x75\160\144\x61\x74\145\40\x73\x75\142\x73\143\x72\x69\160\x74\151\x6f\156\x20\145\x72\x72\x6f\x72\x2e\40\x50\154\145\141\x73\145\x20\163\x75\142\163\143\162\151\x62\145\x20\164\157\40\x72\x65\x63\145\x69\166\x65\40\x74\x68\x65\x20\x61\x70\x70\154\x69\x63\x61\164\151\157\x6e\x20\x75\x70\x64\141\164\x65\163\x2e"); } return $output; } public function invoice() { if (!empty($this->api_key) && !empty($this->app_id)) { $ch = curl_init(); $url = $this->api_endpoint . "\x2f\141\x70\151\57\x6c\145\141\x73\x65\57\160\145\x72\151\x6f\144\151\143\141\x6c\x6c\x79\55\142\x75\x6c\x6b\55\147\145\x6e\x65\162\x61\164\x65\x2d\x69\156\x76\x6f\151\x63\145"; curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_POST, true); $response = curl_exec($ch); if (curl_errno($ch)) { $output = array("\163\164\141\164\165\x73" => "\x65\x72\x72\x6f\x72", "\x6d\145\163\163\141\147\145" => "\103\x75\x72\x6c\x20\145\162\x72\157\x72\72\40" . curl_error($ch)); } else { $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if ($httpCode == 200) { if (isset($response["\x73\164\x61\x74\x75\163"])) { if ($response["\163\164\141\164\165\163"] == "\x73\165\x63\143\x65\x73\x73") { $output = array("\163\x74\x61\164\165\163" => "\163\165\143\143\145\163\x73", "\155\x65\x73\163\x61\x67\145" => $response["\155\145\163\x73\x61\147\x65"]); } else { $output = array("\163\x74\141\164\165\x73" => "\x65\162\162\157\x72", "\x6d\145\163\x73\141\147\145" => $response["\155\x65\163\x73\141\x67\x65"]); } } else { $output = array("\163\x74\x61\x74\x75\163" => "\163\165\143\143\145\163\x73", "\x6d\x65\x73\x73\141\x67\145" => "\x55\x70\x64\141\x74\x65\x73\x20\x65\x72\x72\x6f\162\40\x6f\156\40\144\x6f\167\156\x6c\157\141\x64\x69\x6e\x67\41"); } } else { $output = array("\163\164\x61\164\165\x73" => "\x65\x72\162\157\x72", "\x6d\145\163\x73\x61\147\145" => "\110\x54\124\120\x20\x45\162\x72\157\x72\x3a\x20" . $httpCode); } } curl_close($ch); } else { $output = array("\163\x74\x61\164\165\x73" => "\145\162\x72\x6f\162", "\x6d\145\x73\163\x61\x67\x65" => "\101\120\x49\40\153\x65\x79\x20\x61\x6e\x64\x20\x41\120\x50\40\x49\104\x20\155\x69\x73\x6d\x61\x74\143\x68\x21"); } return $output; } public function isSubscribed($business_id, $service_plan, $application_type = "\144\x69\163\x74\162\151\142\165\164\x69\157\x6e") { $ch = null; try { $ch = curl_init(); $postData = array("\x62\165\x73\151\x6e\x65\163\x73\x5f\x69\144" => $business_id, "\163\x65\162\166\x69\143\145\x5f\x70\x6c\x61\156" => $service_plan, "\x61\x70\x70\x6c\x69\x63\x61\x74\x69\157\x6e\137\x74\x79\160\145" => $application_type, "\x61\x70\151\137\153\x65\x79" => $this->api_key, "\141\x70\160\x5f\151\144" => $this->app_id); curl_setopt($ch, CURLOPT_URL, $this->api_endpoint . "\x2f\141\x70\x69\57\x62\x75\x73\x69\156\145\163\x73\57\x69\x73\55\163\x75\x62\x73\143\162\x69\x62\x65\x64"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData)); $response = curl_exec($ch); if (curl_errno($ch)) { throw new \Exception("\143\125\122\x4c\x20\105\162\x72\x6f\x72\x3a\x20" . curl_error($ch)); } $decodedResponse = json_decode($response, true); if (json_last_error() !== JSON_ERROR_NONE) { throw new \Exception("\112\x53\117\116\x20\104\x65\143\157\x64\145\40\x45\x72\x72\157\162\72\40" . json_last_error_msg()); } if (isset($decodedResponse["\163\164\141\164\165\x73"])) { return $decodedResponse; } else { throw new \Exception("\111\x6e\166\x61\x6c\x69\144\40\162\145\x73\x70\157\156\x73\x65\x20\163\164\162\x75\143\164\x75\x72\145\x2e"); } } catch (\Throwable $th) { return array("\x73\x74\141\164\165\x73" => "\145\162\162\x6f\x72", "\155\x65\x73\163\141\x67\145" => $th->getMessage() ?: "\101\156\x20\145\x72\x72\157\162\x20\157\x63\143\165\x72\x72\x65\x64\x20\x77\x68\x69\154\145\x20\x63\x68\x65\x63\x6b\151\x6e\147\40\x73\x75\x62\x73\x63\x72\x69\x70\164\151\157\x6e\40\163\x74\141\x74\165\163\x2e"); } finally { if ($ch) { curl_close($ch); } } } public function subscriptionTransaction($business_id, $service_plan, $application_type = "\x64\x69\163\x74\x72\151\x62\x75\164\x69\x6f\156") { try { $ch = curl_init(); $postData = array("\142\x75\163\x69\x6e\145\x73\163\x5f\x69\144" => $business_id, "\x73\145\x72\x76\151\143\x65\x5f\x70\x6c\x61\x6e" => $service_plan, "\x61\160\x70\x6c\x69\x63\141\164\151\157\156\137\164\171\x70\x65" => $application_type, "\x61\x70\x69\x5f\153\145\171" => $this->api_key, "\141\x70\160\137\x69\144" => $this->app_id); curl_setopt($ch, CURLOPT_URL, $this->api_endpoint . "\x2f\x61\x70\151\x2f\x62\165\x73\x69\156\x65\x73\x73\57\163\x75\x62\163\x63\x72\x69\x70\164\151\157\156\x2d\x74\162\x61\156\x73\x61\x63\x74\x69\157\x6e"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData)); $response = curl_exec($ch); if (curl_errno($ch)) { echo "\x45\162\x72\x6f\162\72\40" . curl_error($ch); return false; } curl_close($ch); if (!empty($response)) { $decodedResponse = json_decode($response, true); if (json_last_error() === JSON_ERROR_NONE) { if (isset($decodedResponse["\x74\x72\141\x6e\x73\141\143\164\x69\x6f\x6e"])) { return (object) $decodedResponse["\164\x72\x61\x6e\x73\x61\x63\x74\x69\157\156"]; } else { return null; } } else { throw new \Exception("\123\x75\142\163\x63\162\151\x70\164\151\x6f\156\40\124\162\141\156\x73\141\x63\164\x69\x6f\x6e\x20\x4a\x53\117\116\x20\144\x65\x63\x6f\x64\145\x20\x65\162\162\x6f\162\72\x20" . json_last_error_msg()); } } return null; } catch (\Throwable $th) { return array("\x73\x74\x61\164\x75\x73" => "\145\162\x72\157\x72", "\x6d\145\x73\x73\x61\147\145" => !empty($th->getMessage()) ? $th->getMessage() : "\101\156\x20\145\x72\x72\157\162\40\157\x63\x63\165\x72\162\145\x64\40\167\x68\151\x6c\145\40\x63\x68\145\x63\x6b\151\156\147\40\163\165\142\x73\143\x72\x69\x70\x74\151\x6f\x6e\x20\x73\x74\x61\164\x75\163\x2e"); } } public function getBusinesses($application_type = "\144\151\x73\x74\162\151\142\x75\164\151\x6f\x6e") { try { $ch = curl_init(); $postData = array("\141\x70\160\154\151\x63\x61\164\151\x6f\x6e\137\164\x79\160\145" => $application_type, "\141\160\151\x5f\153\145\171" => $this->api_key, "\x61\x70\x70\137\x69\144" => $this->app_id); curl_setopt($ch, CURLOPT_URL, $this->api_endpoint . "\x2f\141\160\x69\57\x62\165\163\151\x6e\x65\163\163\x2f\x67\x65\164\55\x62\x75\x73\151\x6e\145\x73\x73\145\x73"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData)); $response = curl_exec($ch); if (curl_errno($ch)) { throw new \Exception("\x63\x55\x52\114\x20\x45\162\162\x6f\162\72\x20" . curl_error($ch)); } $decodedResponse = json_decode($response, true); if (json_last_error() !== JSON_ERROR_NONE) { throw new \Exception("\x4a\123\117\116\x20\104\145\143\x6f\x64\145\x20\x45\162\x72\157\x72\x3a\x20" . json_last_error_msg()); } if (isset($decodedResponse["\x62\165\163\151\156\x65\x73\163\145\x73"])) { return $this->array_object_mutate($decodedResponse["\142\x75\163\x69\156\145\x73\x73\145\x73"]); } else { return array(); } } catch (\Throwable $th) { return array(); } finally { if ($ch) { curl_close($ch); } } } public function getBusinessById($business_id, $application_type = "\x64\151\163\x74\x72\151\142\165\164\x69\157\x6e") { try { $ch = curl_init(); $postData = array("\x62\x75\163\x69\156\x65\x73\x73\x5f\x69\x64" => $business_id, "\141\160\x70\154\151\143\x61\164\x69\157\x6e\137\164\171\x70\145" => $application_type, "\x61\160\x69\x5f\x6b\145\171" => $this->api_key, "\x61\x70\x70\137\x69\144" => $this->app_id); curl_setopt($ch, CURLOPT_URL, $this->api_endpoint . "\x2f\141\160\151\57\x62\x75\x73\151\156\145\x73\x73\57\147\x65\164\x2d\142\x75\163\151\x6e\145\x73\x73"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData)); sleep(5); $response = curl_exec($ch); if (curl_errno($ch)) { throw new \Exception("\x63\x55\122\114\40\x45\x72\162\x6f\x72\72\x20" . curl_error($ch)); } $decodedResponse = json_decode($response, true); if (json_last_error() !== JSON_ERROR_NONE) { throw new \Exception("\112\123\117\x4e\40\104\145\143\x6f\x64\x65\x20\105\x72\162\x6f\162\x3a\x20" . json_last_error_msg()); } if (isset($decodedResponse["\x62\x75\163\151\156\145\x73\163"])) { return (object) $decodedResponse["\x62\x75\x73\x69\156\145\163\163"]; } else { return array(); } } catch (\Throwable $th) { return array(); } finally { if ($ch) { curl_close($ch); } } } public function updateBusinessSettings($business_id, $input = array(), $application_type = "\144\151\x73\164\x72\151\142\165\x74\x69\157\x6e") { try { $ch = curl_init(); $postData = array("\x62\x75\x73\151\156\x65\x73\163\x5f\151\x64" => $business_id, "\141\x70\x70\154\151\x63\x61\164\x69\x6f\x6e\137\x74\171\160\x65" => $application_type, "\x61\160\151\x5f\153\145\171" => $this->api_key, "\141\160\x70\x5f\x69\144" => $this->app_id); foreach ($input as $key => $value) { $postData[$key] = $value; } curl_setopt($ch, CURLOPT_URL, $this->api_endpoint . "\57\141\x70\151\x2f\142\x75\163\151\156\x65\x73\x73\x2f\x75\x70\x64\141\x74\x65\55\142\x75\163\x69\x6e\145\163\163"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData)); $response = curl_exec($ch); if (curl_errno($ch)) { throw new \Exception("\x63\x55\122\x4c\40\105\162\162\157\x72\72\40" . curl_error($ch)); } $decodedResponse = json_decode($response, true); if (json_last_error() !== JSON_ERROR_NONE) { throw new \Exception("\112\x53\117\x4e\x20\104\145\x63\157\x64\x65\x20\105\x72\162\157\162\x3a\40" . json_last_error_msg()); } if (isset($decodedResponse["\163\164\x61\x74\165\163"])) { return $decodedResponse; } else { throw new \Exception("\111\x6e\x76\x61\x6c\x69\144\x20\x72\x65\163\x70\x6f\x6e\163\x65\40\x73\x74\162\165\143\x74\165\162\x65\56"); } } catch (\Throwable $th) { return array("\x73\164\141\164\165\x73" => "\145\x72\162\157\162", "\x6d\x65\163\163\141\147\x65" => $th->getMessage() ?: "\101\156\x20\145\x72\162\x6f\x72\40\x6f\x63\x63\x75\162\x72\x65\144\x21"); } finally { if ($ch) { curl_close($ch); } } } public function env($var_name) { $dotenv = \Dotenv\Dotenv::createImmutable(getcwd()); $dotenv->load(); return isset($_ENV[strtoupper($var_name)]) ? $_ENV[strtoupper($var_name)] : "\105\156\x76\151\162\157\156\155\x65\x6e\x74\40\166\141\162\151\141\x62\154\145\x20" . $var_name . "\x20\x69\x73\x20\x6e\157\164\x20\163\x65\x74\x20\151\x6e\40\x74\150\145\x20\56\x65\x6e\x76\40\146\x69\154\x65\x2e"; } }